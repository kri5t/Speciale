\documentclass[twoside,11pt,openright]{report}

\usepackage[latin1]{inputenc}
\usepackage[american]{babel}
\usepackage{a4}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{epsfig}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[labeled]{multibib}
\usepackage{color}
\usepackage{datetime}
\usepackage{epstopdf}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{enumitem} %Used to make lists smaller

\renewcommand*\ttdefault{txtt}

\newcommand{\todo}[1]{{\color[rgb]{.5,0,0}\textbf{$\blacktriangleright$#1$\blacktriangleleft$}}}

% \newcites{A,B}{Primary Bibliography,Secondary Bibliography}

% see http://imf.au.dk/system/latex/bog/

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{empty} 
\pagenumbering{roman} 
\vspace*{\fill}\noindent{\rule{\linewidth}{1mm}\\[4ex]
{\Huge\sf An Artificial Neural Network Approach: Combining Green Energy Production and Electricity Price Forecasts to Support Green Decision Making}\\[2ex]
{\huge\sf Brian Bak Laursen, 20071275}\\[2ex]
{\huge\sf Kristan Barret, 20073457}\\[2ex]
\noindent\rule{\linewidth}{1mm}\\[4ex]
\noindent{\Large\sf Master's Thesis, Department of Computer Science, ICT Product Development\\[1ex] 
\monthname\ \the\year  \\[1ex] Advisor: Niels Olof Bouvin\\[15ex]}\\[\fill]}
\epsfig{file=logo.eps}\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{plain}
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}

\todo{in English\dots}

\chapter*{Resum\'e}
\addcontentsline{toc}{chapter}{Resum\'e}

\todo{in Danish\dots}

\chapter*{Acknowledgements}
\addcontentsline{toc}{chapter}{Acknowledgments}

\todo{\dots}

\vspace{2ex}
\begin{flushright}
  \emph{Brian Bak Laursen,}\\
  \emph{Aarhus, \today.}
\end{flushright}

\tableofcontents
\pagenumbering{arabic}
\setcounter{secnumdepth}{2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Introduction}
\label{ch:intro}
\section{The Problem}
Renewable energy has become increasingly important. Energy suppliers make it possible for their customers to choose between and brown energy. Companies and persons promote themselves with green profiles to get a certain kind of image and it has become a choice of the individual company or home to be green. This is only one part of the picture, because the increased attention on green energy is influencing the market forces behind the scenes where acquisition of energy begins \cite{windPowerDanishLiberalized}. Various trading companies buy electricity on the deregulated energy market and since the amount of renewable energy in this market is increasing and will do for the years to come\cite{6, windPowerDanishLiberalized} the traders need to consider it carefully when buying and selling. The most essential task and basis for any decision making in the power market is to forecast the electricity prices \cite{pjmForecast}.
\\[0.5cm]
The electricity market consists of two instruments in order to facilitate trading between producers and consumers of energy: the pool which works as an online marketplace, and a framework to make physical contracts between both sides possible \cite{21}. The producers can make their electricity available and the consumers can bid correspondingly. An auction is made every hour to decide the market clearing price and which bids are accepted for that hour. The consumers and producers need to predict the hourly clearing prices to make plans for which bidding strategies to use. If a trader has a precise day-ahead prediction of the prices it will be easier to maximize profit by using the best possible strategy for exactly those conditions \cite{21}. The Electricity traders will attempt to buy electricity in a low-price market and sell it when the price has come up like in
the commodity market \cite{FIND REF}. With a precise prediction they know when to buy and when to sell. 

Approximately 25\% of the total power production in Western Denmark was covered by wind power in 2008 and could therefore influence the prices on the power market \cite{windPowerDanishLiberalized}. The influence is seen in lower spot-market prices when the production of wind power is higher. Since the amount of green energy in the entire Danish liberalized market is targeted to increase to 30\% by 2025 which is almost a doubling since 2008 \cite{windPowerDanishLiberalized} the influence will only become greater. The price impact from windmills will be even greater in strong wind periods and in areas with congestions in the power transmission capacity \cite{windPowerDanishLiberalized}. The increase in renewable energy makes the ability of predicting green energy production and the corresponding market price more vital. It is not trivial to predict wind production because green energy by nature is unpredictable, e.g. wind turbines only generate energy when the wind is blowing. If the traders are able to predict wind production when doing actual price forecast it will give rise to a huge advantage in the market when deciding to buy or sell. Price forecasting itself contains many factors than wind production that need to be considered equally \cite{21}. 
\\[0.5cm] Traders buy and sell in real-time, intra-day or day-ahead
\cite{FIND REF}. This puts constraints on a price prediction algorithm - but what constraints depend solely on the type of trade. If the trader wishes to buy in real-time or hour-ahead the algorithm must perform and deliver a result within minutes, seconds or perhaps even milliseconds. If it is day-ahead then the time-interval can be increased. This might result in a compromise on the margin of error because fast results make less time for analysis and computation. Another fact is that the closer you get to the time of the trade the more accurate the weather predictions will be which directly impacts the price prediction algorithm using it. The ability to make both short- and long-term forecasts is very important in the deregulated competitive electricity market because it helps the trader to reduce risks in terms of under/over estimating the revenues from potential sales and this of course also makes it easier to manage risk\cite{21}.
\\[0.5cm]
Demand has a huge influence on the electricity price. No demand, no electricity price, but if these were the only two variables to consider, a linear regression model could be used for establishing a relationship and thereby a prediction. Other dynamic elements have an impact on the price and therefore the linear regression approach would result in the presence of serial correlation in the error \cite{21}. For example will overestimated energy prices for one year most likely lead to overestimates the next year because it does not account for all the dynamic parameters. It is necessary to carefully consider all variables and characteristics of the price that we are trying to predict in the electricity market and then use a model that handles correlated errors based on the this. The most noticeable characteristics are \cite{21}:
\begin{itemize}
\item High frequency;
\item High volatility;
\item Unusual prices in times of very high demand.
\item Calendar effect (weekend, holidays)
\item Multiple seasonality
\end{itemize}
When doing electricity price forecasting these characteristics must be taken into consideration when modelling a prediction algorithm. 
\section{Related Work}
This section will give an overview of concepts within the area of price and green energy prediction as well as decision support. The presented concepts will be elaborated as the thesis progress.

\subsection{Price Prediction Systems}
\input{sections/ForecastingStock/StockPricePrediction.tex}
\\[0.5cm]
A day-ahead forecasting algorithm that predicts electricity prices in the market based on Neural Network (ANN) and Similar Days Method (SDM) is described in \cite{pjmForecast}. The purpose is to give close estimates for several days to come. The estimates can be used by electricity traders in their decision making but also by transmission companies for different purposes. The companies can use it for scheduling a short-term generator outage in order to predict where it is most inexpensive. It can also be used by actual producers of energy to strategically bid into the market to increase prices. The price estimate itself plays a huge role in decision making in all of these examples.

The combination of ANN and SDM is an attempt to simplify the ANN and make the prediction more accurate. The algorithm forecasts by using a ANN that modifies price curves obtained by averaging five similar price days corresponding to the forecast day, i.e. The ANN corrects the received output from the similar days approach \cite{pjmForecast}. In other words the technique takes into consideration the influence of the most similar days and their price development in relation to the day we wish to forecast.

The ANN is trained with only 45 days from the day before the forecast and 45 days before and after the forecast day in the previous year \cite{pjmForecast}.
 
\subsection{Green Energy Production}
When dealing with prediction of green energy production it is necessary to look at the weather in more detail. In this thesis we will be focusing on energy that originates from windmills. 

Wind energy prediction can be divided into two areas \cite{5}: 1) time-series analysis of power data and 2) wind speed prediction and conversion to power. What needs to be utilized in wind energy prediction is wind speed and wind direction which of course has a big influence on how much energy a wind turbine generate. An approach to analysis and prediction of wind power generation is presented in \cite{WindPowerGenerationUsingANN} where an Artificial Neural Network is used to predict the production. The prediction is based on weather data such as wind speed, relative humidity but also for how many hours the windmill is generating power. 
\\[0.5cm]
Another source of green energy is solar panels. Solar
prediction algorithms are very accurate when the weather conditions are steady but in changing weather a large error margin is seen. To predict power output from a solar farm the time-series prediction algorithms and Estimated Weighted Moving Average (EWMA) models can be used \cite{5}.

\subsection{Decision Support Systems}

\section{The Method}
We will base our work on Artificial Neural Networks and the resilient backpropagation (RPROP) algorithm used to train the network in order to predict electricity prices and wind power generation. It is faster than its predecessor Backpropagation \cite{8,15}.  The RPROP algorithm is a learning algorithm that uses weights to analyze the input dataset and to configure further learning \cite{17}. It is commonly used on the feedforward architecture and is the most used and implemented algorithm \cite{14,17}.
\\[0.5cm] 
The prediction algorithm will be based on historical data which potentially could be a very large dataset. The more historical data included in the algorithm the more data needs to be processed. We need to investigate how much of this data is necessary for precise prediction and perhaps make tradeoffs to ensure performance for decision support.
\\[0.5cm]
Based on the dataset that is available and the nonlinear nature of price forecasting and energy price prediction we want a system that is able to develop and learn from the past. Artificial Neural Networks can be categorized as Machine Learning \cite{18} and are networks that imitate the behaviour of the human brain \cite{1}. This gives us the power to be able to forecast energy prices based on how the prices have evolved in the past and therefore we chose to use Artificial Neural Networks to base our model upon. Our decision is based on the nature of Artificial Neural Networks and how it is used in machine learning. It is often used in non-linear statistical analysis \cite{16} and has been used to predict the prices of brown energy \cite{2,3}. We have chosen to use a multi-layered feed forward architecture since this is one of the most used and widely implemented in open-source frameworks \cite{17}.

\section{The hypothesis}
In this dissertation we take our outset in the growing need for predicting green energy prices. It is our intent to show that we can predict green energy prices by gathering weather data from online sources and combine it with historical price development data in a prediction algorithm based on a Back Propagation Artificial Neural Network. In our concrete case the prediction itself is to be used as decision support by energy traders in their attempt to beat the electricity market. We will be focusing on 1) building a Back Propagation Artificial Neural Network that is able to predict prices; 2) creating a web service for real-time fetching of the predicted prices. 
\\[0.5cm] 
The goal of the thesis is to investigate whether or not Back Propagation Artificial Neural Networks(BPNN) are a proper way to predict energy prices. The BPNN shall as a minimum be able to predict energy prices based on historical data like in \cite{2} and weather data. Based on this minimum requirement we will explore if 1) the prediction algorithm can come "some percentage" close to real-world data (the percentage needs to be defined!!); 2) the algorithm can be expanded to also include prediction of green energy prices; 3) real-time fetching of prices.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{The Foundations}
This chapter will introduce and explain the technologies and concepts that are the foundation for the thesis. bla bla
\label{ch:foundations}
\section{Machine Learning}
Machine learning algorithms can figure out how to perform tasks by generalizing and where the goal is to generalize beyond the examples of a training set \cite{18}. The programs using the algorithm learn from data and as more data becomes available, more complex problems can be handled. Systems such as web search, spam filters and stock trading uses this approach.
\\[0.5cm]
Many learning algorithms exist and they are all based on combinations of three components \cite{18}; 1) the \textbf{representation} component makes an attempt to discover how to represent the input during training of the algorithm. What kind of information expressed in the data decides what representation algorithm to use; 2) the \textbf{evaluation} component has the objective of distinguishing between the best and the worst output from the representation component and let the next component decide which choice is the best. Basically it attempts to map the output to a specific value so that the next component can analyze it; 3) finally, the \textbf{optimization} component needs to search for the highest scoring output from the evaluation and then deliver it as a result. A greedy search could be an example of such a search (see figure ~\ref{fig:threeComponents}).
\begin{figure}[h!]
\centering
\includegraphics[width=0.6\linewidth,natwidth=898,natheight=587]{billeder/Table1-TheComponentsOfLearningAlgorithms.png}
\caption{The three components of learning algorithms \cite{18}}
\label{fig:threeComponents}
\end{figure}
\\[0.5cm] 
Machine learning cannot rely on data alone. Every learner must make assumptions beyond the data that is given to generalize beyond it \cite{18} because it is not possible to map the real world uniformly to a possible mathematical function. When meteorologists try to model the weather they make assumptions based on historical datasets that are similar to the current weather conditions. If enough historical occurrences resulted in the same weather condition the meteorologists must make the assumption that it can be classified as what have been seen before. The same is applicable when predicting electricity prices. We examine historical data and locate situations that are similar to the current and if enough examples with the same result is found it can be assumed that they are of the same type.
\\[0.5cm]
It can be the case that the system is not at all able to deliver a correct answer. This could result in the system guessing to the best of its ability or simply randoming an answer. This problem is called overfitting \cite{18}. Overfitting can be divided into bias and variance, where bias is when the learner consistently learns the same wrong thing over and over again. Variance is the learner's tendency to learn random things and ignoring the possibility of a more correct answer. See figure ~\ref{fig:biasandvariance} for an example with dart throwing.
\begin{figure}[h!]
\centering
\includegraphics[width=0.5\linewidth,natwidth=898,natheight=587]{billeder/biasVSvariance.png}
\caption{Example of bias and variance in a dart throw \cite{18}}
\label{fig:biasandvariance}
\end{figure}

Machine learning is not only about the technical stuff but it also relies a great deal on intuition, creativity and  black art \cite{18}. 
\newline A way to achieve machine learning is by using a Artificial Neural Network. One way to model an ANN is to base it on the
Levenberg-Marquardt algorithm \cite{7,9,10}. It is a least squares algorithm that,
opposed to Backpropagation algorithm\cite{8}, is very fast at calculating the
results. It is a curve fitting algorithm mostly used on nonlinear problems with
a lot of unknowns[Need citation]. The algorithm can be used with Artificial Neural Networks and information approximation\cite{8} and it can be used in combination with the backpropagation algorithm to be used on a feedforward architecture of the neural network\cite{13}.
\section{Prediction}
Being able to predict electricity prices, demand and green energy production is the basis for our thesis. This section will introduce and give examples of these concepts. 

\subsection{Electricity Demand}
Weather conditions have a huge impact on the electricity industry in terms of network infrastructure and electricity consumption. In \cite{19} they describe a multiple regression model that accurately predicts the monthly electricity demand based on weather and sociocultural conditions. The monthly electricity demand from this model shows a clear cyclic pattern which reflects the temperature changes during the year \cite{19}. Besides weather conditions, social and economic factors also affect the monthly demand, e.g. the demand was decreased in Denmark during the financial crisis in 2009 \cite{20}. 
\\[0.5cm]
Parametric multiple regression is preferred in \cite{19} as opposed to an Artificial Neural Network used in this thesis. From a statistical error indices point of view the Artificial Neural Network (ANN) is a valid choice for prediction (see figure ~\ref{fig:anncomparison}) in comparison with a plain socioeconomic model (SE) and a Box and Jenkins model (B\&J). The argument for multiple regression is the simplicity in adjusting input values for each analysis of electricity demand in the prediction model and in the end they show similar results to ANN. 
\begin{figure}[h!]
\centering
\includegraphics[width=0.8\linewidth,natwidth=898,natheight=587]{billeder/StatisticalErrorOfNeuralNetworksAndRegression.png}
\caption{Shows ANN compared to B\&J and SE \cite{19} }
\label{fig:anncomparison}
\end{figure}
To make a demand prediction based on weather conditions a relationship between the two needs to be established. To get an understanding of this relationship, a plot of the average monthly demand as a function of Central England Temperature (CET) can be made \cite{19}. The plot (see figure ~\ref{fig:CET}) shows an inverse relationship where it can be seen that a lower temperature in general results in an increased load consumption. Winter gives rise to lighting and heating load which is consistent with lower temperatures, and conversely in the summer with temperatures above 18 degrees the consumption tends to increase again due to the need for cooling and air-condition \cite{19}.
\begin{figure}[h!]
\centering
\includegraphics[width=0.8\linewidth,natwidth=898,natheight=587]{billeder/MeanMonthlyDemandEngland.png}
\caption{Function of monthly CET as a function from 1970 to 1995 \cite{19}}
\label{fig:CET}
\end{figure}
The nonlinear relationship between temperature and load consumption is turned into a concept called degree days. They introduce two categories of days; 1) Heating Degree Days (HDD) that is used to quantify when heating is required; 2) Cooling Degree Days (CDD) which is then used to quantify the need for cooling. The days are calculated from the CET data and give a more indicative picture than the temperature-load relationship \cite{19}. A simple explanation of the calculation follows.
\begin{center}
$CDD=\sum\limits_{d=1}^{N_{d}}(\gamma_{d})(T_{dm}-T_{base_{C}})$
\end{center} 
 
where $T_{base_{c}} = 20^{\circ}$ is the base temp and $T_{dm}$ is the mean daily temperature. $\gamma_{d} = 0$ if $T_{dm}-T_{base_{c}} < 0$ and $\gamma_{d} = 1$ if $T_{dm}-T_{base_{c}} > 0$. In other words if the temperature if above $20^{\circ}$ the day can be characterized as CDD and there is a need for cooling.
\begin{center}
$HDD=\sum\limits_{d=1}^{N_{d}}(1-\gamma_{d})(T_{base_{H}}-T_{dm})$
\end{center} 

where $T_{base_{h}} = 15.5^{\circ}$ is the base temp and again $T_{dm}$ is the mean daily temperature. $\gamma_{d} = 1$ if $T_{base_{h}}-T_{dm} < 0$ and $\gamma_{d} = 0$ if $T_{base_{h}}-T_{dm} > 0$. This means that on a day with temperatures below 15.5 degrees there is a need for heating. In both cases where $\gamma_{d} != 0$ a big difference has a greater impact on the demand.

Temperature is the most influential factor but other weather conditions can also be used when calculating the electricity demand, e.g. wind speed and rainfall can impact heating and lighting demand whereas direct sunshine can decrease the need for heating \cite{19}. The model can be expressed by the relation between all factors by adding them together, e.g. the HDD value automatically increase the total electricity demand if it is not zero and this apply to all other factors in the model seen below.

\begin{center} \^E$_{A}=\alpha_{0}+\alpha_{1}CDD+\alpha_{2}HDD+\alpha_{3}ELD
+\alpha_{4}V_{w}+\alpha_{5}M_{s}+\alpha_{6}M_{r}$ 
\end{center} 
 
Where $a_{n}$ are constants, ELD is humidity, $V_{w}$ is windfall, $M_{s}$ sunshine and $M_{r}$ rainfall.
The calculation model can also include socio-economic factors. Specifically the population growth has a natural impact on the electricity demand over time. The more people the higher the demand gets. This would give rise to an additional factor in the model considering the growth. The prediction model from \cite{19} comes within 3 percentage of the actual demand when it is run on data from 1996-2003 which is fairly close (~\ref{fig:predicteddemand}).
\newline
\begin{figure}[h!]
\centering
\includegraphics[width=0.8\linewidth,natwidth=898,natheight=587]{billeder/PredictionOfDemand.png}
\caption{The actual values and the predicted demand in a comparison \cite{19}}
\label{fig:predicteddemand}
\end{figure}
%\section{Green Energy Production}
\subsection{Green Energy Production}
\input{sections/PowerGenerationPrediction/analysisOfPowerGenerationPRediction.tex}
The vitality of the forecasts is seen when it comes to
placement of wind farms. Before investing billions of dollars in a new wind farm it is of utmost importance to put it in the best possible location in relation to wind statistics, e.g. force of the wind and how often the winds change in power and direction at the position. In \cite{4} they use MCP to predict wind statistics based on large amount of geographical-, weather- and historical data so that the farms can be placed best possible. This knowledge can in some way be transferred to our specific purpose but because we are dealing with decision making in real time we cannot use as heavy algorithms that do calculations for several weeks and months before giving a result. We must deliver the most accurate estimate without delaying the trader's work.
There is also a big difference in using billions of dollars on windmills. The companies have to be 100 percent certain that they can produce energy where you put them. When doing decision support we only aid the trader in his daily work by giving him a real time estimate for the next hour or perhaps the next week - they still need to take the final decision based on their experience and knowledge. In addition, we can also assume that the wind mills are placed in a the best possible location where we only need to predict the energy production based on the current weather.

%\section{Electricity Prices}
\subsection{Electricity Prices}
 \input{sections/ARIMA/ArimaPrediction.tex}
% \\[0.5cm]
% \input{sections/ForecastingStock/StockPricePrediction.tex}
%\\[0.5cm]
%\input{sections/SimilarDaysApporach/SDMandANN.tex}
\\[0.5cm]
\input{sections/SVMforecasting/SVMforecasting.tex}

%\section{Electricity Demand}

\subsection{Applications}
Prediction algorithms are not only used by electricity traders but can also be a part of various applications. In \cite{22} they introduce an intelligent electricity broker (IEB) that is integrated into Smart Grids where it; 1) provides provision of en energy storage; 2) attempts to lower the electricity bill, and 3) optimally utilizes electricity during peak and low-peak energy production periods. The prediction algorithm is used by a decision algorithm to locate points in time where it is most feasible for the owner of the smart grid to either sell stored energy or buy energy if storage is low. It helps the system to lower the total amount of energy costs to the owner and also utilize the energy in the most intelligent way.
\\[0.5cm]
\input{sections/ScheduleJobsInDataCenters/scheduledJobs.tex}

\subsection{Summary}

\section{Decision support}
\subsection{Decision Support Systems}
\input{sections/DecisionSupport/DecisionSupport.tex}
\subsection{Presentation of Uncertain Information}
\input{sections/UncertainInformationPresentation/UncertaintInfo.tex}
\subsection{Summary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Artificial Neural Network}

\input{sections/NeuralNetworkSection/NeuralNetworkSection.tex}
\subsection{Summary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Conclusion}
\label{ch:conclusion}

\todo{\dots}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\addcontentsline{toc}{chapter}{Bibliography}
\bibliographystyle{plain} 
\bibliography{refs}

\end{document}

